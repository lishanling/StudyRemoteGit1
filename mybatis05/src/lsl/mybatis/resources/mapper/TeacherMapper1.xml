<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lsl.mybatis.mapper.TeacherMapper">
	<!-- 分页查询语句 -->
	<resultMap type="PaginationBean" id="PaginationBeanMap">
		<id column="total" property="total" />
		<id column="totalPage" property="totalPage" />
		<collection property="rows" ofType="Teacher">
			<id column="id" property="id" />
			<result column="name" property="name" />
		</collection>
	</resultMap>
	<!--在映射文件中'<' 是特殊符号，不可用 -->
	<select id="partTeachers" parameterType="PaginationBean"
		resultMap="PaginationBeanMap">
		select ${currPage},${pageSize} pageSize ,(select count(1) from teacher)
		total,(select ceil(count(1)/${pageSize}) from teacher) totalPage
		,ts.* from (select t.*,rownum r from teacher t where
		${pageSize}*${currPage}>=rownum) ts
		where r>(${currPage}-1)*${pageSize}
	</select>
	
	<select id="partTeachers" parameterType="PaginationBean" resultMap="PaginationBeanMap">
	  select count(1) total, ceil(count(1)/5) totalPage from teacher
	</select>
</mapper>